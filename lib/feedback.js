"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),_elementsNitrogenFeedbackElement=require("./elements/nitrogen-feedback-element"),_elementsNitrogenFeedbackElement2=_interopRequireDefault(_elementsNitrogenFeedbackElement),_atom=require("atom"),_emitter=require("./emitter"),_emitter2=_interopRequireDefault(_emitter),_jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),Feedback=function(){function e(){var t=this;_classCallCheck(this,e),this.subscriptions=null,this.modalPanel=null,this.handleModalPanelDidChangeVisible=function(e){e?((0,_jquery2["default"])("body").on("click.nitrogen-feedback",function(e){return 0===(0,_jquery2["default"])(e.target).closest("nitrogen-feedback").length?void t.hide():void 0}).on("keydown.nitrogen-feedback",function(e){27===e.keyCode&&t.hide()}),t.feedbackEl.component.focusTitle()):(0,_jquery2["default"])("body").off("click.nitrogen-feedback").off("keydown.nitrogen-feedback")},this.show=function(){t.modalPanel.show()},this.hide=function(){t.modalPanel.hide()}}return _createClass(e,[{key:"activate",value:function(){var e=this;this.subscriptions=new _atom.CompositeDisposable,this.feedbackEl=new _elementsNitrogenFeedbackElement2["default"],this.subscriptions.add(atom.commands.add("atom-workspace",{"nitrogen:show-feedback-dialog":function(){e.show()}})),this.modalPanel=atom.workspace.addModalPanel({item:this.feedbackEl,visible:!1}),this.subscriptions.add(this.modalPanel.onDidChangeVisible(this.handleModalPanelDidChangeVisible)),_emitter2["default"].on("hide-feedback-dialog",this.hide)}},{key:"deactivate",value:function(){_emitter2["default"].off("hide-feedback-dialog",this.hide),this.feedbackEl.destroy(),this.subscriptions.dispose()}}]),e}();exports["default"]=new Feedback,module.exports=exports["default"];