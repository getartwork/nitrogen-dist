"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function backoff(e,t){var r=1e3;e>5&&10>=e?r=2e3:e>10&&(r=5e3),window.setTimeout(t,r)}function ajax(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return e.url&&(e.url=_config2["default"].nitrousHost+e.url),new Promise(function(t,r){var o=0,n=function a(){_jquery2["default"].ajax(e).then(function(e){t(e)},function(t){if(e.retry)return void backoff(++o,a);var n=void 0,i=t.responseJSON;i&&(n=i.error_description||i.error),n=n||t.status+" "+(t.statusText||"unknown error"),t.errorMessage=n,r(t)})};n()})}function authedAjax(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];e=Object.assign({},e),e.headers=e.headers||{},e.headers.Authorization="Bearer "+_storesTokenStore2["default"].token;var t=ajax(e);return t["catch"](function(e){var t=e.responseJSON;return t&&"confirmation_lapsed"===t.error?void _actionsTokenActions2["default"].invalidate("confirmation_lapsed"):void(401===e.status&&_actionsTokenActions2["default"].invalidate())}),t}Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),_storesTokenStore=require("./stores/token-store"),_storesTokenStore2=_interopRequireDefault(_storesTokenStore),_actionsTokenActions=require("./actions/token-actions"),_actionsTokenActions2=_interopRequireDefault(_actionsTokenActions),_config=require("./config"),_config2=_interopRequireDefault(_config);exports["default"]={ajax:ajax,authedAjax:authedAjax},module.exports=exports["default"];