"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_get=function(t,e,r){for(var n=!0;n;){var i=t,o=e,u=r;n=!1,null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,o);if(void 0!==l){if("value"in l)return l.value;var a=l.get;if(void 0===a)return;return a.call(u)}var c=Object.getPrototypeOf(i);if(null===c)return;t=c,e=o,r=u,n=!0,l=c=void 0}},_store=require("./store"),_store2=_interopRequireDefault(_store),_actionsSnackbarActions=require("../actions/snackbar-actions"),_actionsSnackbarActions2=_interopRequireDefault(_actionsSnackbarActions),_utilStringUtil=require("../util/string-util"),_utilStringUtil2=_interopRequireDefault(_utilStringUtil),_utilIwc=require("../util/iwc"),_utilIwc2=_interopRequireDefault(_utilIwc),NsyncStore=function(t){function e(){var t=this;_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._runnerReady=!1,this._port=null,this._runnerReady=_utilStringUtil2["default"].parseBool(_utilIwc2["default"].getEnv("NSYNC_RUNNER_READY")),this._port=_utilStringUtil2["default"].atoi(_utilIwc2["default"].getEnv("NSYNC_PORT")),_utilIwc2["default"].on("nsync-runner.ready",function(){t._runnerReady=!0,t.notifyChange()}),_utilIwc2["default"].on("nsync-runner.server-running",function(e){t._port=e,t.notifyChange()}),_utilIwc2["default"].on("nsync-runner.server-killed",function(){t._port=null,_actionsSnackbarActions2["default"].post("Sync server killed!","error"),t.notifyChange()})}return _inherits(e,t),_createClass(e,[{key:"handleAction",value:function(t){switch(t.type){case"token.invalidate":return void _utilIwc2["default"].send("nsync-runner.kill-server");default:return}this.notifyChange()}},{key:"runnerReady",get:function(){return this._runnerReady}},{key:"port",get:function(){return this._port}},{key:"running",get:function(){return!!this._port}}]),e}(_store2["default"]);exports["default"]=new NsyncStore,module.exports=exports["default"];