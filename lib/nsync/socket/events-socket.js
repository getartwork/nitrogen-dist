"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}return function(t,n,c){return n&&e(t.prototype,n),c&&e(t,c),t}}(),eventedSocket=require("./evented-socket"),emitter=require("../../emitter"),iwc=require("../../util/iwc"),EventsSocket=function(){function e(){_classCallCheck(this,e),this._socket=null}return _createClass(e,[{key:"connect",value:function(e,t){var n=e.replace("http","ws");t&&(n=n+"?token="+t),this._socket=new eventedSocket(n),this._socket.on("message",this.handleMessage),this._socket.connect()}},{key:"disconnect",value:function(){this._socket&&this._socket.disconnect()}},{key:"handleMessage",value:function(e){var t=void 0;try{t=JSON.parse(e)}catch(n){return}var c="events:"+t.name.replace(/_/g,"-"),s=t.data;console.log(c,s),emitter.emit(c,s),iwc.send(c,s)}},{key:"connected",get:function(){return!!this._socket&&this._socket.connected}}]),e}();module.exports=new EventsSocket;