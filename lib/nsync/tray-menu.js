"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),remote=require("remote"),app=remote.require("app"),Tray=remote.require("tray"),Menu=remote.require("menu"),settingStore=require("./stores/setting-store"),platform=require("../util/platform"),resources=require("./resources"),emitter=require("../emitter"),TrayMenu=function(){function e(){var t=this;_classCallCheck(this,e);var n=this._tray=new Tray(resources.trayIcon(!1,!1,!1));n.on("clicked",function(e,t){n.popUpContextMenu({x:Math.floor(t.x+t.width/3),y:Math.floor(t.y+t.height/3)})}),this.render(),settingStore.onChange(function(){t.render()}),emitter.on("show-notification",this.showNotification.bind(this))}return _createClass(e,[{key:"render",value:function(){var e=this._tray,t=[{label:"Open Nitrogen...",click:this.handleOpenNitrogen.bind(this)},{label:"Open Debug Window...",click:this.handleOpenWindow.bind(this)},{type:"separator"},{label:"Quit Nitrogen...",accelerator:platform.isMac?"Command+Q":"Alt+F4",click:this.handleQuit.bind(this)}];e.setContextMenu(Menu.buildFromTemplate(t)),e.setToolTip("Nitrogen");var n=settingStore.isAnyContainerSyncing();e.setImage(resources.trayIcon(!0,!1,n)),e.setPressedImage(resources.trayIcon(!0,!0,n))}},{key:"handleOpenNitrogen",value:function(){var e={preventDefault:function(){}};app.emit("open-file",e)}},{key:"handleOpenWindow",value:function(){var e=remote.getCurrentWindow();e.show(),e.setMenu(null),e.setMenuBarVisibility(!1)}},{key:"handleQuit",value:function(){app.emit("request-quit")}},{key:"showNotification",value:function(e){var t="Nitrogen";platform.isWindows?this._tray.displayBalloon({title:t,content:e}):Notification.requestPermission(function(n){"granted"===n&&new Notification(t,{body:e})})}}]),e}();module.exports=new TrayMenu;